mysql> show databases;

mysql> CREATE DATABASE SalesDB;

mysql> USE SalesDB;
Database changed
mysql> CREATE TABLE Customer (
         customer_id INT PRIMARY KEY,
         customer_name VARCHAR(100) NOT NULL,
         city VARCHAR(50),
         email VARCHAR(100)
     );

mysql> CREATE TABLE Product (
         product_id INT PRIMARY KEY,
         product_name VARCHAR(100) NOT NULL,
         category VARCHAR(50),
         price DECIMAL(10,2) CHECK (price >= 0)
     );

mysql> CREATE TABLE Sale (
         sale_id INT PRIMARY KEY,
         customer_id INT,
         product_id INT,
         quantity INT CHECK (quantity > 0),
         sale_date DATE DEFAULT (CURRENT_DATE),
         total_amount DECIMAL(10,2) CHECK (total_amount >= 0),
         FOREIGN KEY (customer_id) REFERENCES Customer(customer_id),
         FOREIGN KEY (product_id) REFERENCES Product(product_id)
     );

mysql> INSERT INTO Customer VALUES
      (1, 'Asha Patil', 'Pune', 'asha@gmail.com'),
      (2, 'Rahul Deshmukh', 'Mumbai', 'rahul@gmail.com'),
      (3, 'Priya Kulkarni', 'Nashik', 'priya@gmail.com'),
      (4, 'Vikram Joshi', 'Pune', 'vikram@gmail.com');

mysql> INSERT INTO Customer VALUES
      (1, 'Asha Patil', 'Pune', 'asha@gmail.com'),
      (2, 'Rahul Deshmukh', 'Mumbai', 'rahul@gmail.com'),
      (3, 'Priya Kulkarni', 'Nashik', 'priya@gmail.com'),
      (4, 'Vikram Joshi', 'Pune', 'vikram@gmail.com');

mysql> INSERT INTO Sale VALUES
     (1, 1, 101, 1, '2025-10-10', 55000.00),
     (2, 2, 102, 2, '2025-10-15', 60000.00),
     (3, 3, 103, 1, '2025-10-18', 8000.00),
     (4, 1, 105, 2, '2025-10-25', 8000.00),
     (5, 4, 104, 3, '2025-10-28', 7500.00),
     (6, 2, 101, 1, '2025-10-30', 55000.00);

mysql> SELECT
         c.customer_name,
         SUM(s.total_amount) AS total_sales
     FROM Sale s
     JOIN Customer c ON s.customer_id = c.customer_id
     GROUP BY c.customer_name;

mysql> SELECT
         p.product_name,
         SUM(s.quantity) AS total_quantity_sold
     FROM Sale s
     JOIN Product p ON s.product_id = p.product_id
     GROUP BY p.product_name;

mysql> SELECT
         MAX(price) AS highest_price,
         MIN(price) AS lowest_price
     FROM Product;

mysql> SELECT
         c.city,
         AVG(s.total_amount) AS avg_sales_amount
     FROM Sale s
     JOIN Customer c ON s.customer_id = c.customer_id
     GROUP BY c.city;

mysql> SELECT
         p.category,
         SUM(s.total_amount) AS total_sales,
         COUNT(s.sale_id) AS transaction_count
     FROM Sale s
     JOIN Product p ON s.product_id = p.product_id
     GROUP BY p.category;

mysql> SELECT
         c.customer_name,
         SUM(s.total_amount) AS total_purchase
     FROM Sale s
     JOIN Customer c ON s.customer_id = c.customer_id
     GROUP BY c.customer_name
     HAVING SUM(s.total_amount) > (
         SELECT AVG(total_amount)
         FROM Sale
     );

mysql> CREATE TEMPORARY TABLE CustomerSummary AS
     SELECT
         customer_id,
         SUM(total_amount) AS total_sales
     FROM Sale
     GROUP BY customer_id;

mysql> SELECT *
     FROM CustomerSummary
     WHERE total_sales > 10000;

mysql> SELECT
         p.product_name,
         COUNT(s.sale_id) AS times_sold
     FROM Product p
     LEFT JOIN Sale s ON p.product_id = s.product_id
     GROUP BY p.product_name;

mysql> SELECT DISTINCT c.customer_name
     FROM Customer c
     WHERE c.customer_id IN (
         SELECT s.customer_id
         FROM Sale s
         JOIN Product p ON s.product_id = p.product_id
         WHERE p.category = 'Electronics'
     );

